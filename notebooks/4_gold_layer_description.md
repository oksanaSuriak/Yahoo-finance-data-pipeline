
## Рівень: Gold (Агреговані дані)

### Опис структури та логіки

На золотому рівні проводиться агрегація оброблених даних із срібного рівня (`silver`). Дані групуються за часовими інтервалами (день, тиждень, місяць) та компанією. Застосовуються статистичні функції для обчислення середнього значення та волатильності цін закриття (Close).


1. **Читання срібного шару:**
   - Дані зчитуються з шляху `/FileStore/delta/silver_stock`.

2. **Агрегація добових метрик:**
   - Групування по `Year`, `Month`, `Day`, `Company`.
   - Обчислення середнього значення (`avg`) та стандартного відхилення (`stddev`) ціни закриття за день.

3. **Агрегація тижневих метрик:**
   - Додавання колонки `Week` з номером тижня у році.
   - Групування по `Year`, `Week`, `Company`.
   - Обчислення середнього значення та волатильності за тиждень.

4. **Агрегація місячних метрик:**
   - Групування по `Year`, `Month`, `Company`.
   - Обчислення середнього значення та волатильності за місяць.

5. **Запис результатів:**
   - Збереження результатів в окремі Delta-таблиці:
     - `/FileStore/delta/gold_daily_stock`
     - `/FileStore/delta/gold_weekly_stock`
     - `/FileStore/delta/gold_monthly_stock`

### Структура логування
Після збереження створюється запис у лог-таблиці `/FileStore/delta/etl_log`, який містить:
- `timestamp`: дата й час оновлення
- `pipeline_level`: "gold_stock_data"
- `source_file`: шлях до джерела (silver)
- `gold_daily_count` :кількість доданих записів
- `gold_weekly_count`:кількість доданих записів
- `gold_monthly_count`:кількість доданих записів

## Бізнес-цінність

Gold рівень містить зведену, агреговану інформацію, з якою зручно працювати бізнес-аналітикам, аналітикам даних та системам BI.

### Добові метрики
- **Бізнес-цінність:**
  - Оцінка поточної волатильності та динаміки ринку в режимі майже реального часу.
  - Використовується трейдерами та фінансовими аналітиками для оперативного моніторингу.
- **Приклади використання:**
  - Побудова дашбордів зі щоденною зміною цін.
  - Виявлення аномальних коливань на короткому горизонті.

### Тижневі метрики
- **Бізнес-цінність:**
  - Дає змогу спостерігати тренди та циклічні коливання протягом тижня.
  - Служить основою для прийняття рішень середньострокової перспективи.
- **Приклади використання:**
  - Порівняння продуктивності компаній за тиждень.
  - Створення моделей сезонності.

### Місячні метрики
- **Бізнес-цінність:**
  - Дає огляд довгострокових трендів.
  - Корисна для стратегічного планування та інвесторської аналітики.
- **Приклади використання:**
  - Звіти для топменеджменту.
  - Оцінка ефективності інвестиційних стратегій.

