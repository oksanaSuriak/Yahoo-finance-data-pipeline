
## Рівень: Silver (Очищені дані)

### Опис структури та логіки

Срібний рівень відповідає за **очищення, трансформацію та стандартизацію** даних, що надходять з Bronze.

1. **Інкрементальне оновлення**: 
   - Якщо в срібному шарі ще немає даних або остання дата < 2025-06-10, завантажуються всі дані з Bronze.
   - В іншому випадку — тільки нові, щоденні записи.

2. **Очищення та перетворення**:
   - Перетворення типів: `Date` → дата, фінансові показники → числові.
   - Видалення дублікатів на рівні `Date + Company`.
   - Заповнення пропущених значень (NaN) нулями у ключових колонках: `Open`, `Close`, `Volume`.
   - Генерація нових колонок для агрегації в наступному шарі: `Year`, `Month`, `Day`, `Week`.

3. **Збереження**:
   - Дані записуються в Delta Lake таблицю `/FileStore/delta/silver_stock` з розділенням (`partitionBy`) по `Year` і `Month`.
   - Застосовується `mergeSchema = true` для гнучкості при зміні структури.

###  Структура логування

Після збереження створюється запис у лог-таблиці `/FileStore/delta/etl_log`, який містить:

- `timestamp`: дата й час оновлення
- `pipeline_level`: "silver_stock_data"
- `source_file`: шлях до джерела (bronze)
- `record_count`: кількість записів після обробки
- `null_count`: кількість пропущених значень (до заповнення)
- `duplicates_removed`: кількість видалених дублікатів


### Бізнес-цінність

Срібний рівень є основою для подальшого аналітичного використання:

- Забезпечує **якісні, узгоджені дані** без дублікатів та помилок типів
- Дозволяє створювати агрегати (напр. середні ціни) без спотворення
- Покращує продуктивність завдяки партиціюванню

### Приклади використання

- Побудова базових дашбордів для цін акцій
- Визначення аномалій у щоденних цінах
- Створення агрегованих звітів (перехід на Gold)