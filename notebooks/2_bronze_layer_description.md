
##  Рівень: Bronze (Сирі дані)

### Опис структури та логіки

На бронзовому рівні зберігаються **сирі (raw) дані**, отримані з CSV-файлів, сформованих з Yahoo Finance. Файл завантажується історично (з 01.01.2020 до 10.06.2025) та щодня в подальшому. Визначення типу файлу (`з заголовком` або `без заголовку`) відбувається автоматично через умову `if "2025_06_10" in file_path`.

Файл зчитується за допомогою PySpark, без автоматичного визначення схеми (`inferSchema = False`), що дозволяє уникнути помилок типізації.Щоденний CSV-файл не має заголовку, явно задаються назви колонок: `Date`, `Company`, `Open`, `High`, `Low`, `Close`, `Volume`.

Після зчитування датафрейм записується у форматі Delta Lake в розділ `/FileStore/delta/bronze_stock` з режимом `append`, що дозволяє накопичувати дані з кожним днем.

### Структура логування

Після збереження створюється запис у лог-таблиці `/FileStore/delta/etl_log`, який містить:

- `timestamp`: час завантаження
- `pipeline_level`: назва рівня (bronze)
- `source_file`: шлях до CSV-файлу
- `record_count`: кількість доданих записів
- інші поля (null_count, duplicates_removed, gold_daily_count...) заповнюються `None`, бо поки не застосовуються на цьому етапі

### Бізнес-цінність

Бронзовий рівень є фундаментальним для побудови пайплайну. Він:

- Зберігає **повні сирі дані** без втрат і трансформацій
- Служить джерелом для відновлення даних у випадку збоїв
- Дозволяє перевіряти відповідність даних на ранньому етапі

### Приклади використання

- Дебаг/аудит первинних значень з Yahoo Finance
- Перевірка якості даних до трансформацій
- Побудова тестових моделей на "брудних" даних